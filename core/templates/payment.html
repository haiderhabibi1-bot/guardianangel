{% extends 'base.html' %}
{% block content %}
<div style="text-align:center;">
    <h2 class="metallic-text">Secure Payment</h2>

    <div style="max-width:500px; margin:30px auto; background:white;
                padding:25px; border-radius:10px;
                box-shadow:0 3px 12px rgba(0,0,0,0.1); text-align:left;">

        <h3 style="margin-top:0;">Chat with {{ chat.lawyer.user.username }}</h3>

        {% if chat.related_customer_question %}
            <p><strong>Based on your question:</strong> "{{ chat.related_customer_question.title }}"</p>
            <p><strong>Client Offered Price:</strong> ${{ base }} CAD</p>
        {% else %}
            <p><strong>Lawyer Question Price:</strong> ${{ base }} CAD</p>
        {% endif %}

        <hr>

        <p><strong>Platform Fee:</strong> ${{ platform_fee }} CAD</p>
        <p><strong>Estimated Tax:</strong> ${{ tax_amount }} CAD</p>
        <p style="font-size:1.1em; font-weight:bold; margin-top:10px;">
            Total: ${{ amount }} CAD
        </p>

        <p style="margin-top:15px; font-size:0.9em; color:#666;">
            By confirming this payment, you unlock a dedicated chat with this lawyer for this specific question.
            Each new chat may require a new payment.
        </p>

        <form method="post" style="text-align:center; margin-top:20px;">
            {% csrf_token %}
            <button type="submit" class="btn">
                {% if stripe_public_key %}
                    Pay Securely
                {% else %}
                    Confirm Payment (Demo Mode)
                {% endif %}
            </button>
        </form>

        {% if not stripe_public_key %}
            <p style="margin-top:10px; font-size:0.85em; color:#999;">
                Payments are currently running in demo mode for testing. No real charges will be made.
            </p>
        {% endif %}
    </div>
</div>
{% endblock %}
